warnings()
for (i in test)
{
if(test<1)
{
malevec<-append(malevec,NA)
}
}
test<-(newdat2[,1:5])
head(test)
test<-(newdat2[,1:5])
head(test)
malevec = NULL
for (i in 1:nrow(test))
{
if(test$winner=0)
{
malevec<-append(malevec,NA)
}
}
malevec = NULL
for (i in 1:nrow(test))
{
if(test$winner[i]=0)
{
malevec<-append(malevec,NA)
}
}
for (i in 1:nrow(test))
{
if(test$winner[i]==0)
{
malevec<-append(malevec,NA)
}
}
malevec
length(malevec)
length(test$winner)
malevec = NULL
for (i in 1:nrow(test))
{
if(test$winner[i]==[i])
{
malevec<-append(malevec,NA)
}
}
for (i in 1:nrow(test))
{
if(test$winner[i]==[i])
{
malevec<-append(malevec,NA)
}
}
nrow(test)
for (i in 1:nrow(test))
{
if(test$winner[i]>0)
{
malevec<-append(malevec,2)
}
}
malevec
test$winner
head(test)
test<-split(test,test$maleid)
test
nrow(test)
nrow(test$lizard01)
nrow(test$lizard)
test$lizard01
or(i in (test$lizard01))
{
if(test$lizard01[i-1]==1)
{
malevec<-c(malevec,1)
}
}
for(i in (test$lizard01))
{
if(test$lizard01$winner[i-1]==1)
{
malevec<-c(malevec,1)
}
}
malevec
malevec = NULL
for(i in (test$lizard01))
{
if(test$lizard01$winner[i-1]==1)
{
malevec<-c(malevec,1)
}
}
for(i in (test$lizard01))
{
if(test$lizard01$winner[i]==1)
{
malevec<-c(malevec,1)
}
}
test$lizard01$winner
for(i in 1:nrow(test$lizard01$winner))
{
if(test$lizard01$winner[i]==1)
{
malevec<-c(malevec,1)
}
}
nrow(test$lizard01$winner)
for(i in 1:nrow(test$lizard01))
{
if(test$lizard01$winner[i]==1)
{
malevec<-c(malevec,1)
}
}
malevec
for(i in 1:nrow(test$lizard01))
{
if(test$lizard01$winner[i]==1)
{
malevec<-c(malevec,a)
}
}
malevec
malevec = NULL
for(i in 1:nrow(test$lizard01))
{
if(test$lizard01$winner[i]==1)
{
malevec<-c(malevec,a)
}
}
malevec
malevec = NULL
for(i in 1:nrow(test$lizard01))
{
if(test$lizard01$winner[i]==1)
{
malevec<-c(malevec,5)
}
}
malevec
test$lizard54
for(i in 1:nrow(test$lizard54))
{
if(test$lizard54$winner[i]==1)
{
malevec<-c(malevec,1)
}
}
malevec = NULL
for(i in 1:nrow(test$lizard54))
{
if(test$lizard54$winner[i]==1)
{
malevec<-c(malevec,1)
}
}
malevec
malevec = NULL
for(i in 1:nrow(test$lizard54))
{
if(test$lizard54$winner[i]==1)
{
malevec<-c(malevec,1)
}
else(test$lizard54$winner[i]<1)
{
malevec<-c(malevec,0)
}
}
malevec
test$lizard54
malevec = NULL
for(i in 1:nrow(test$lizard54))
{
if(test$lizard54$winner[i]==1)
{
malevec<-c(malevec,1)
}
else(test$lizard54$winner[i]==0)
{
malevec<-c(malevec,0)
}
}
malevec
?"else:"
?"else"
?'else'
malevec = NULL
for(i in 1:nrow(test$lizard54))
{
if(test$lizard54$winner[i]=='1')
{
malevec<-c(malevec,1)
}
else(test$lizard54$winner[i]=='0')
{
malevec<-c(malevec,0)
}
}
malevec #Not working output has 6 elements in it??
malevec = NULL
for(i in 1:nrow(test$lizard54))
{
if(test$lizard54$winner[i]==i)
{
malevec<-c(malevec,2)
}
else(test$lizard54$winner[i]=='1')
{
malevec<-c(malevec,1)
}
}
malevec #Not working output has 6 elements in it??
test$lizard54$winner
malevec = NULL
for(i in 1:nrow(test$lizard54))
{
if(test$lizard54$winner[i-1]==1)
{
malevec<-c(malevec,1)
}
else(test$lizard54$winner[i-1]==0)
{
malevec<-c(malevec,0)
}
}
exp(-2.0775)/(1+exp(-2.0775))
cordat <- read.csv("~/Dropbox/Water Skinks Social Learning/cordat.csv")
View(cordat)
cor(cordat$blue_latency1, cordat$blue_latency2)
cordat
cordat <- read.csv("~/Dropbox/Water Skinks Social Learning/cordat.csv")
View(cordat)
cor(cordat$blue_latency1, cordat$blue_latency2)
cordat
?cor
cor(cordat$blue_latency1, cordat$blue_latency2, na.rm=F)
cor(cordat$blue_latency1, cordat$blue_latency2, na.rm=FALSE)
cordat2<-na.omit(cordat)
cordat2
cor(cordat2$blue_latency1, cordat2$blue_latency2)
cor(cordat2$white_latency1, cordat2$white_latency2)
cor(cordat2$white_latency1, cordat2$white_latency2, method =p)
cor(cordat2$white_latency1, cordat2$white_latency2, method =c("p"))
cor(cordat2$white_latency1, cordat2$white_latency2, method =c("p"))
(0.8522624+0.8289126)/2
plot(cordat$blue_latency1~cordat$blue_latency2)
plot(cordat$white_latency1~cordat$white_latency2)
par(mfrow=c(2,2))
plot(cordat$blue_latency1~cordat$blue_latency2)
plot(cordat$white_latency1~cordat$white_latency2)
par(mfrow=c(1,2))
plot(cordat$white_latency1~cordat$white_latency2)
plot(cordat$blue_latency1~cordat$blue_latency2)
cont.init = c(1,0,1,0)
escalate = c(0,0,1,1)
prior.win = 1
sc.mass = 0
log.odds = -1.9959 + 4.0816*cont.init + 1.2473*escalate + 0.4234*sc.mass -0.0987 *prior.win -3.0708 *(cont.init*escalate)
odds = exp(log.odds)
p = odds/(1+odds)
log.oddsUP = (-1.9959 +(0.4107)) + (4.0816+(0.6027))*cont.init + (1.2473+(0.5547 ))*escalate + (0.4234+(0.2525))*sc.mass - (0.0987+(0.4704))*prior.win - (3.0708 +(0.8359))*(cont.init*escalate)
## To get odds we exponentiate
oddsUP = exp(log.oddsUP)
## To get the predicted probablity we calculate as follows
pUP = oddsUP/(1+oddsUP)
log.oddsL = (-1.9959 -(0.4107)) + (4.0816-(0.6027))*cont.init + (1.2473-(0.5547 ))*escalate + (0.4234-(0.2525))*sc.mass - (0.0987-(0.4704))*prior.win - (3.0708-(0.8359))*(cont.init*escalate)
oddsL = exp(log.oddsL)
pL = oddsL/(1+oddsL)
dat <- data.frame(cont.init, escalate, p, pUP, pL, value = 1:4)
dat$escalate<-as.factor(dat$escalate)
dat
dat <- data.frame(cont.init, escalate, p, pUP, pL, value = c(0.7,1.74,2.78,3.83))
dat
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1.08),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5, font=2),  line =3.2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5,font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
legend(x=2, y=0.98, legend=c("Non-escalated contests", "Escalated contests"), fill= c("grey", "white"), cex= 1.2, text.font=2)
prior.win = c(1,0)
sc.mass = 0
log.odds = -0.3168  + 0.7097 *prior.win  +0.1226*sc.mass
odds = exp(log.odds)
p = odds/(1+odds)
log.oddsUP = (-0.3168+(0.1889)) + (0.7097+(0.3075))*prior.win  +  (0.1226+(0.1484))*sc.mass
oddsUP = exp(log.oddsUP)
pUP = oddsUP/(1+oddsUP)
log.oddsL= (-0.3168-(0.1889)) + (0.7097-(0.3075))*prior.win  +  (0.1226-(0.1484))*sc.mass
oddsL = exp(log.oddsL)
pL = oddsL/(1+oddsL)
dat2 <- data.frame(prior.win, p, pUP, pL, value=c(1,3))
dat2
dat2 <- data.frame(prior.win, p, pUP, pL, value=c(0.30,0.75))
dat2
barplot(dat2$p, ylim = c(0,1),xlim=c(0,1), width=.3, space= .5, cex.axis=1.5, col=c("grey", "white"))
title(ylab = list("Probability of initiating a contest", font =2, cex=1.5),line =3)
mtext("Won previous contest", at= 0.30, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Lost previous contest", at=0.77, side =1,line = 1.2, cex=1.5, font=2)
arrows(x0 = dat2$value, y0 = dat2$p, x1 = dat2$value, y1 = dat2$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat2$value, y0 = dat2$p, x1 = dat2$value, y1 = dat2$pL, length = 0.05, angle = 90, lwd= 3)
segments(x0 =0.30, y0=0.75, x1 = 0.75, y1 = 0.75, lwd= 3)
text(x=0.52, y=0.8, labels="*", cex=2, font=2)
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5, font=2),  line =3.2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5,font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
legend(x=2, y=0.98, legend=c("Non-escalated contests", "Escalated contests"), fill= c("grey", "white"), cex= 1.2, text.font=2)
data <- read.csv("~/Desktop/thomas.csv")
View(data)
str(data)
outcome$winner<-data[outcome==1,ID]
outcome$winner<-data[outcome==1,data$ID]
outcome$winner<-data[outcome==1,"ID"]
outcome$winner<-data[data$outcome==1,"ID"]
data$outcome<-as.factor(data$outcome)
outcome$winner<-data[data$outcome==1,"ID"]
outcome<-NULL
outcome$winner<-data[data$outcome==1,"ID"]
outcome$loser<-data[data$outcome==0,"ID"]
str(outcome)
exp(1.2255)/(1+ exp(1.2255))
exp(0.9527)/(1+ exp(0.9527))
install.packages(c("boot", "class", "cluster", "codetools", "corpcor", "evaluate", "foreign", "KernSmooth", "knitr", "lattice", "lme4", "manipulate", "MASS", "Matrix", "mgcv", "mime", "nlme", "nnet", "plyr", "Rcpp", "RcppEigen", "rmarkdown", "rpart", "spatial", "stringi", "survival"))
?plogis
con.init<-c(1,0,1,0)
escalate<-c(0,0,1,1)
p<-c(0.8562147,0.1437853, 0.5893793, 0.4106207)
se<-c(0.07450935, 0.08856152, 0.08829307, 0.09224241)
pUP=p+se
pL=p-se
dat <- data.frame(con.init, escalate, p, pUP, pL, value = 1:4)
dat <- data.frame(cont.init, escalate, p, pUP, pL, value = c(0.7,1.74,2.78,3.83))
dat <- data.frame(con.init, escalate, p, pUP, pL, value = c(0.7,1.74,2.78,3.83))
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5),  line =3.2, font=2)
font=2
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5, font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=2)
segments(x0 =0.7, y0=0.96, x1 = 1.7, y1 =0.96, lwd= 3)
text(x=1.2, y=0.99, labels="**", cex=2, font=2)
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5),  line =3.2, font=2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5, font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
segments(x0 =0.7, y0=0.96, x1 = 1.7, y1 =0.96, lwd= 3)
text(x=1.2, y=0.99, labels="**", cex=2, font=2)
segments(x0 =2.8, y0=0.71, x1 = 3.8, y1 =0.71, lwd= 3)
text(x=3.3, y=0.74, labels="**", cex=2, font=2)
title(ylab = list("Probability of winning a contest", cex=1.5),  line =3.2, cex.lab=1.5)
title(ylab = list("Probability of winning a contest", cex=1.5),  line =3.2, cex.lab=2)
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5),  line =3.2, cex.lab=2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5, font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
segments(x0 =0.7, y0=0.96, x1 = 1.7, y1 =0.96, lwd= 3)
text(x=1.2, y=0.99, labels="**", cex=2, font=2)
segments(x0 =2.8, y0=0.71, x1 = 3.8, y1 =0.71, lwd= 3)
text(x=3.3, y=0.74, labels="**", cex=2, font=2)
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5),  line =3.2, cex.lab=2)
title(ylab = list("Probability of winning a contest"),  line =3.2, cex.lab=2)
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest"),  line =3.2, cex.lab=1.5)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
title(ylab = list("Probability of winning a contest", cex.lab=1.5, font=2),  line =3.2)
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex.lab=1.5, font=2),  line =3.2)
title(ylab = list("Probability of winning a contest", cex=1.8, font=2),  line =3.2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5, font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
segments(x0 =0.7, y0=0.96, x1 = 1.7, y1 =0.96, lwd= 3)
text(x=1.2, y=0.99, labels="**", cex=2, font=2)
segments(x0 =2.8, y0=0.71, x1 = 3.8, y1 =0.71, lwd= 3)
text(x=3.3, y=0.74, labels="**", cex=2, font=2)
```
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5, font=2),  line =3.2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5, font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
segments(x0 =0.7, y0=0.96, x1 = 1.7, y1 =0.96, lwd= 3)
text(x=1.2, y=0.99, labels="**", cex=2, font=2)
segments(x0 =2.8, y0=0.71, x1 = 3.8, y1 =0.71, lwd= 3)
text(x=3.3, y=0.74, labels="**", cex=2, font=2)
title(ylab = list("Probability of winning a contest", cex=1.8, font=2),  line =3.2)
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.8, font=2),  line =3.2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5, font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
segments(x0 =0.7, y0=0.96, x1 = 1.7, y1 =0.96, lwd= 3)
text(x=1.2, y=0.99, labels="**", cex=2, font=2)
segments(x0 =2.8, y0=0.71, x1 = 3.8, y1 =0.71, lwd= 3)
text(x=3.3, y=0.74, labels="**", cex=2, font=2)
```
of exp(1.7842)/(1+ exp(1.7842))
exp(1.7842)/(1+ exp(1.7842))
exp(1.0224)/(1+ exp(1.0224))
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5, font=2),  line =3.2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5, font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
segments(x0 =0.7, y0=0.96, x1 = 1.7, y1 =0.96, lwd= 3)
text(x=1.2, y=0.99, labels="**", cex=2, font=2)
segments(x0 =2.8, y0=0.71, x1 = 3.8, y1 =0.71, lwd= 3)
text(x=3.3, y=0.74, labels="**", cex=2, font=2)
cont.init = c(1,0)
prior.win = 1
sc.mass = 0
log.odds = -1.49052  + 2.83457*cont.init +  0.40149 *sc.mass +0.01367  *prior.win
odds = exp(log.odds)
p = odds/(1+odds)
log.oddsUP = (-1.49052 +(0.31055)) + (2.83457+( 0.40318))*cont.init + (0.40149+(0.23140))*sc.mass + (0.01367 +(0.45038))*prior.win
oddsUP = exp(log.oddsUP)
pUP = oddsUP/(1+oddsUP)
log.oddsL = (-1.9959 -(1.96*0.4107)) + (4.0816-(1.96*0.6027))*cont.init + (1.2473-(1.96*0.5547 ))*escalate + (0.4234-(1.96*0.2525))*sc.mass - (0.0987-(1.96*0.4704))*prior.win - (3.0708-(1.96*0.8359))*(cont.init*escalate)
log.oddsL = (-1.49052 -(0.31055)) + (2.83457-( 0.40318))*cont.init + (0.40149-(0.23140))*sc.mass + (0.01367 -(0.45038))*prior.win
oddsL = exp(log.oddsL)
pL = oddsL/(1+oddsL)
dat <- data.frame(cont.init, p, pUP, pL, value =c(1,2))
dat
par(xaxt="n", mar=c(4,5,2,3))
plot(p ~ value,  ylim = c(0, 1), xlab = "", ylab="", pch = 21, cex =2, bg = c("grey","white")[dat$escalate], tcl=0, cex.axis=1.5, data = dat)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=2)
title(ylab = list("Predicted probability of winning a contest", cex=1.8, font=2), line =3)
mtext("Initator", at= c(1,0), side = 1,line = 1.5, cex=1.8, font=2)
mtext("Non-initiator", at=c(2,0), side =1,line = 1.5, cex= 1.8,font=2)
mtext("Initator", at= c(3,0), side = 1,line = 1.5, cex= 1.8,font=2)
mtext("Non-initiator", at=c(3.9,0), side =1,line = 1.5, cex= 1.8, font=2)
dat <- data.frame(cont.init, p, pUP, pL, value = c(0.3,0.75))
dat
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1.10),xlim=c(0,1), width=0.3, space=0.5, cex.axis=1.5, col=c("grey", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5, font=2),  line =3.2)
mtext("Initiator", at= 0.3, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=0.77, side =1,line = 1.2, cex= 1.5,font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
par(xaxt="n", mar=c(4,5,2,3))
con.init<-c(1,0,1,0)
escalate<-c(0,0,1,1)
p<-c(0.8562147,0.1437853, 0.5893793, 0.4106207)
se<-c(0.07450935, 0.08856152, 0.08829307, 0.09224241)
pUP=p+se
pL=p-se
dat <- data.frame(con.init, escalate, p, pUP, pL, value = 1:4)
dat <- data.frame(con.init, escalate, p, pUP, pL, value = c(0.7,1.74,2.78,3.83))
par(xaxt="n", mar=c(4,5,2,3))
barplot(dat$p, ylim = c(0,1),xlim=c(0,4), width=0.70, space=0.49, cex.axis=1.5, col=c("grey", "grey", "white", "white"))
title(ylab = list("Probability of winning a contest", cex=1.5, font=2),  line =3.2)
mtext("Initiator", at= 0.7, side = 1,line = 1.2, cex=1.5, font=2)
mtext("Non-initiator", at=1.8, side =1,line = 1.2, cex= 1.5,font=2)
mtext("Initiator", at= 2.8, side = 1,line = 1.2, cex= 1.5, font=2)
mtext("Non-initiator", at=3.9, side =1,line = 1.2, cex= 1.5, font=2)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pUP, length = 0.05, angle = 90, lwd=3)
arrows(x0 = dat$value, y0 = dat$p, x1 = dat$value, y1 = dat$pL, length = 0.05, angle = 90, lwd=3)
segments(x0 =0.7, y0=0.96, x1 = 1.7, y1 =0.96, lwd= 3)
text(x=1.2, y=0.99, labels="**", cex=2, font=2)
segments(x0 =2.8, y0=0.71, x1 = 3.8, y1 =0.71, lwd= 3)
text(x=3.3, y=0.74, labels="**", cex=2, font=2)
setwd("~/Dropbox/social learning/output/data/")
revdat <- read.csv("task3_final.csv", stringsAsFactors = FALSE)
learningphase<-revdat[revdat$lt == 1, ]
learningphase$LizardID<-factor(learningphase$LizardID)
str(learningphase)
